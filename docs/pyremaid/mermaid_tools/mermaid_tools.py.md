# ./src/pyremaid/mermaid_tools/mermaid_tools.py

### Imports

  - [models.MermaidBlock](/docs/pyremaid/models.py.md)
  - [models.MermaidClass](/docs/pyremaid/models.py.md)
  - [models.MermaidElement](/docs/pyremaid/models.py.md)
  - [models.MermaidFor](/docs/pyremaid/models.py.md)
  - [models.MermaidFunction](/docs/pyremaid/models.py.md)
  - [models.MermaidLink](/docs/pyremaid/models.py.md)
  - [models.MermaidNode](/docs/pyremaid/models.py.md)

---
```mermaid
flowchart TB
  _f20_n59["node_set = []"]
  _f20_l21["element"]
  _f20_l21_n60["If"]
  _f20_l21_n61["isinstance(element, MermaidLink)"]
  _f20_l21_n62["link: MermaidLink = element"]
  _f20_l21_n63["If"]
  _f20_l21_n64["link.from_ not in node_set"]
  _f20_l21_n65["Expr"]
  _f20_l21_n66["node_set.append(link.from_)"]
  _f20_l21_n67["If"]
  _f20_l21_n68["link.to not in node_set"]
  _f20_l21_n69["Expr"]
  _f20_l21_n70["node_set.append(link.to)"]
  _f20_l21_n71["If"]
  _f20_l21_n72["isinstance(element, MermaidBlock)"]
  _f20_l21_n73["block: MermaidBlock = element"]
  _f20_l21_n74["Expr"]
  _f20_l21_n75["node_set.extend(_get_unique_nodes(block.block_contents))"]
  _f20_n76["return node_set"]
  _f22_n77["alias_string = ''"]
  _f22_l23["node"]
  _f22_l23_n78["alias_string += f'{TAB * indent}{node.mermaid_safe_name}[''{node.display_name}'']\n'"]
  _f22_n79["return _sanitize(alias_string)"]
  _f24_n80["from_name = link.from_.mermaid_safe_name"]
  _f24_n81["to_name = link.to.mermaid_safe_name"]
  _f24_n82["return f'{TAB * indent}{from_name} -- {to_name}\n'"]
  _f25_n83["connection_text = ''"]
  _f25_l26["element"]
  _f25_l26_n84["If"]
  _f25_l26_n85["isinstance(element, MermaidLink)"]
  _f25_l26_n86["link: MermaidLink = element"]
  _f25_l26_n87["connection_text += _get_flow_link_text(link=link, indent=indent)"]
  _f25_l26_n88["If"]
  _f25_l26_n89["isinstance(element, MermaidBlock)"]
  _f25_l26_n90["block: MermaidBlock = element"]
  _f25_l26_n91["connection_text += _get_block_text(block=block, indent=indent)"]
  _f25_n92["return connection_text"]
  _f27_n93["block_text = ''"]
  _f27_n94["If"]
  _f27_n95["isinstance(block, MermaidFunction)"]
  _f27_n96["function_def: MermaidFunction = block"]
  _f27_n97["block_text += f'{TAB * indent}subgraph {function_def.display_name}\n'"]
  _f27_n98["block_text += f'{TAB * (indent + 1)}direction TB\n'"]
  _f27_n99["block_text += _get_flow_connections(function_def.block_contents, indent + 1)"]
  _f27_n100["block_text += f'{TAB * indent}end\n'"]
  _f27_n101["If"]
  _f27_n102["isinstance(block, MermaidClass)"]
  _f27_n103["class_def: MermaidClass = block"]
  _f27_n104["block_text += f'{TAB * indent}subgraph {class_def.display_name}\n'"]
  _f27_n105["block_text += f'{TAB * (indent + 1)}direction TB\n'"]
  _f27_n106["block_text += _get_flow_connections(class_def.block_contents, indent + 1)"]
  _f27_n107["block_text += f'{TAB * indent}end\n'"]
  _f27_n108["If"]
  _f27_n109["isinstance(block, MermaidFor)"]
  _f27_n110["for_def: MermaidFor = block"]
  _f27_n111["block_text += f'{TAB * indent}%% loop {for_def.display_name}\n'"]
  _f27_n112["block_text += _get_flow_connections(for_def.block_contents, indent + 1)"]
  _f27_n113["block_text += f'{TAB * indent}%% end {for_def.display_name}\n'"]
  _f27_n114["block_text += _get_flow_connections(block.block_contents, indent)"]
  _f27_n115["return block_text"]
  _f28_n116["alaises = _get_aliases_for_safe_names(elements=elements)"]
  _f28_n117["flow_connections = _get_flow_connections(elements=elements)"]
  _f28_n118["return f'```mermaid\nflowchart TB\n{alaises}\n{flow_connections}\n```\n'"]

  subgraph __sanitize
    direction TB
  end
  subgraph __get_unique_nodes
    direction TB
    _f20_n59 --> _f20_l21
    %% loop element
      _f20_l21_n60 --> _f20_l21_n61
      _f20_l21_n61 --> _f20_l21_n62
      _f20_l21_n62 --> _f20_l21_n63
      _f20_l21_n63 --> _f20_l21_n64
      _f20_l21_n64 --> _f20_l21_n65
      _f20_l21_n65 --> _f20_l21_n66
      _f20_l21_n66 --> _f20_l21_n67
      _f20_l21_n67 --> _f20_l21_n68
      _f20_l21_n68 --> _f20_l21_n69
      _f20_l21_n69 --> _f20_l21_n70
      _f20_l21_n70 --> _f20_l21_n71
      _f20_l21_n71 --> _f20_l21_n72
      _f20_l21_n72 --> _f20_l21_n73
      _f20_l21_n73 --> _f20_l21_n74
      _f20_l21_n74 --> _f20_l21_n75
    %% end element
    _f20_l21_n75 --> _f20_l21_n60
    _f20_l21_n60 --> _f20_n76
  end
  subgraph __get_aliases_for_safe_names
    direction TB
    _f22_n77 --> _f22_l23
    %% loop node
    %% end node
    _f22_l23_n78 --> _f22_l23_n78
    _f22_l23_n78 --> _f22_n79
  end
  subgraph __get_flow_link_text
    direction TB
    _f24_n80 --> _f24_n81
    _f24_n81 --> _f24_n82
  end
  subgraph __get_flow_connections
    direction TB
    _f25_n83 --> _f25_l26
    %% loop element
      _f25_l26_n84 --> _f25_l26_n85
      _f25_l26_n85 --> _f25_l26_n86
      _f25_l26_n86 --> _f25_l26_n87
      _f25_l26_n87 --> _f25_l26_n88
      _f25_l26_n88 --> _f25_l26_n89
      _f25_l26_n89 --> _f25_l26_n90
      _f25_l26_n90 --> _f25_l26_n91
    %% end element
    _f25_l26_n91 --> _f25_l26_n84
    _f25_l26_n84 --> _f25_n92
  end
  subgraph __get_block_text
    direction TB
    _f27_n93 --> _f27_n94
    _f27_n94 --> _f27_n95
    _f27_n95 --> _f27_n96
    _f27_n96 --> _f27_n97
    _f27_n97 --> _f27_n98
    _f27_n98 --> _f27_n99
    _f27_n99 --> _f27_n100
    _f27_n100 --> _f27_n101
    _f27_n101 --> _f27_n102
    _f27_n102 --> _f27_n103
    _f27_n103 --> _f27_n104
    _f27_n104 --> _f27_n105
    _f27_n105 --> _f27_n106
    _f27_n106 --> _f27_n107
    _f27_n107 --> _f27_n108
    _f27_n108 --> _f27_n109
    _f27_n109 --> _f27_n110
    _f27_n110 --> _f27_n111
    _f27_n111 --> _f27_n112
    _f27_n112 --> _f27_n113
    _f27_n113 --> _f27_n114
    _f27_n114 --> _f27_n115
  end
  subgraph _create_mermaid_flow_graph_from_links
    direction TB
    _f28_n116 --> _f28_n117
    _f28_n117 --> _f28_n118
  end

```
---

<details>
<summary>Debug AST model dump</summary>

```
Module(
  body=[
    ImportFrom(
      module='models',
      names=[
        alias(
          name='MermaidBlock',
          lineno=2,
          col_offset=4,
          end_lineno=2,
          end_col_offset=16),
        alias(
          name='MermaidClass',
          lineno=3,
          col_offset=4,
          end_lineno=3,
          end_col_offset=16),
        alias(
          name='MermaidElement',
          lineno=4,
          col_offset=4,
          end_lineno=4,
          end_col_offset=18),
        alias(
          name='MermaidFor',
          lineno=5,
          col_offset=4,
          end_lineno=5,
          end_col_offset=14),
        alias(
          name='MermaidFunction',
          lineno=6,
          col_offset=4,
          end_lineno=6,
          end_col_offset=19),
        alias(
          name='MermaidLink',
          lineno=7,
          col_offset=4,
          end_lineno=7,
          end_col_offset=15),
        alias(
          name='MermaidNode',
          lineno=8,
          col_offset=4,
          end_lineno=8,
          end_col_offset=15)],
      level=0,
      lineno=1,
      col_offset=0,
      end_lineno=9,
      end_col_offset=1),
    Assign(
      targets=[
        Name(
          id='TAB',
          ctx=Store(),
          lineno=11,
          col_offset=0,
          end_lineno=11,
          end_col_offset=3)],
      value=Constant(
        value='  ',
        lineno=11,
        col_offset=6,
        end_lineno=11,
        end_col_offset=10),
      lineno=11,
      col_offset=0,
      end_lineno=11,
      end_col_offset=10),
    FunctionDef(
      name='_sanitize',
      args=arguments(
        posonlyargs=[],
        args=[
          arg(
            arg='markdown',
            annotation=Name(
              id='str',
              ctx=Load(),
              lineno=14,
              col_offset=24,
              end_lineno=14,
              end_col_offset=27),
            lineno=14,
            col_offset=14,
            end_lineno=14,
            end_col_offset=27)],
        kwonlyargs=[],
        kw_defaults=[],
        defaults=[]),
      body=[
        Return(
          value=Call(
            func=Attribute(
              value=Call(
                func=Attribute(
                  value=Name(
                    id='markdown',
                    ctx=Load(),
                    lineno=16,
                    col_offset=8,
                    end_lineno=16,
                    end_col_offset=16),
                  attr='replace',
                  ctx=Load(),
                  lineno=16,
                  col_offset=8,
                  end_lineno=17,
                  end_col_offset=16),
                args=[
                  Constant(
                    value='<',
                    lineno=17,
                    col_offset=17,
                    end_lineno=17,
                    end_col_offset=20),
                  Constant(
                    value='',
                    lineno=17,
                    col_offset=21,
                    end_lineno=17,
                    end_col_offset=23)],
                keywords=[],
                lineno=16,
                col_offset=8,
                end_lineno=17,
                end_col_offset=24),
              attr='replace',
              ctx=Load(),
              lineno=16,
              col_offset=8,
              end_lineno=18,
              end_col_offset=16),
            args=[
              Constant(
                value='>',
                lineno=18,
                col_offset=17,
                end_lineno=18,
                end_col_offset=20),
              Constant(
                value='',
                lineno=18,
                col_offset=21,
                end_lineno=18,
                end_col_offset=23)],
            keywords=[],
            lineno=16,
            col_offset=8,
            end_lineno=18,
            end_col_offset=24),
          lineno=15,
          col_offset=4,
          end_lineno=19,
          end_col_offset=5)],
      decorator_list=[],
      returns=Name(
        id='str',
        ctx=Load(),
        lineno=14,
        col_offset=32,
        end_lineno=14,
        end_col_offset=35),
      lineno=14,
      col_offset=0,
      end_lineno=19,
      end_col_offset=5),
    FunctionDef(
      name='_get_unique_nodes',
      args=arguments(
        posonlyargs=[],
        args=[
          arg(
            arg='elements',
            annotation=Subscript(
              value=Name(
                id='list',
                ctx=Load(),
                lineno=22,
                col_offset=32,
                end_lineno=22,
                end_col_offset=36),
              slice=Name(
                id='MermaidElement',
                ctx=Load(),
                lineno=22,
                col_offset=37,
                end_lineno=22,
                end_col_offset=51),
              ctx=Load(),
              lineno=22,
              col_offset=32,
              end_lineno=22,
              end_col_offset=52),
            lineno=22,
            col_offset=22,
            end_lineno=22,
            end_col_offset=52)],
        kwonlyargs=[],
        kw_defaults=[],
        defaults=[]),
      body=[
        Assign(
          targets=[
            Name(
              id='node_set',
              ctx=Store(),
              lineno=24,
              col_offset=4,
              end_lineno=24,
              end_col_offset=12)],
          value=List(
            elts=[],
            ctx=Load(),
            lineno=24,
            col_offset=15,
            end_lineno=24,
            end_col_offset=17),
          lineno=24,
          col_offset=4,
          end_lineno=24,
          end_col_offset=17),
        For(
          target=Name(
            id='element',
            ctx=Store(),
            lineno=25,
            col_offset=8,
            end_lineno=25,
            end_col_offset=15),
          iter=Name(
            id='elements',
            ctx=Load(),
            lineno=25,
            col_offset=19,
            end_lineno=25,
            end_col_offset=27),
          body=[
            If(
              test=Call(
                func=Name(
                  id='isinstance',
                  ctx=Load(),
                  lineno=26,
                  col_offset=11,
                  end_lineno=26,
                  end_col_offset=21),
                args=[
                  Name(
                    id='element',
                    ctx=Load(),
                    lineno=26,
                    col_offset=22,
                    end_lineno=26,
                    end_col_offset=29),
                  Name(
                    id='MermaidLink',
                    ctx=Load(),
                    lineno=26,
                    col_offset=31,
                    end_lineno=26,
                    end_col_offset=42)],
                keywords=[],
                lineno=26,
                col_offset=11,
                end_lineno=26,
                end_col_offset=43),
              body=[
                AnnAssign(
                  target=Name(
                    id='link',
                    ctx=Store(),
                    lineno=27,
                    col_offset=12,
                    end_lineno=27,
                    end_col_offset=16),
                  annotation=Name(
                    id='MermaidLink',
                    ctx=Load(),
                    lineno=27,
                    col_offset=19,
                    end_lineno=27,
                    end_col_offset=30),
                  value=Name(
                    id='element',
                    ctx=Load(),
                    lineno=27,
                    col_offset=33,
                    end_lineno=27,
                    end_col_offset=40),
                  simple=1,
                  lineno=27,
                  col_offset=12,
                  end_lineno=27,
                  end_col_offset=40),
                If(
                  test=Compare(
                    left=Attribute(
                      value=Name(
                        id='link',
                        ctx=Load(),
                        lineno=28,
                        col_offset=15,
                        end_lineno=28,
                        end_col_offset=19),
                      attr='from_',
                      ctx=Load(),
                      lineno=28,
                      col_offset=15,
                      end_lineno=28,
                      end_col_offset=25),
                    ops=[
                      NotIn()],
                    comparators=[
                      Name(
                        id='node_set',
                        ctx=Load(),
                        lineno=28,
                        col_offset=33,
                        end_lineno=28,
                        end_col_offset=41)],
                    lineno=28,
                    col_offset=15,
                    end_lineno=28,
                    end_col_offset=41),
                  body=[
                    Expr(
                      value=Call(
                        func=Attribute(
                          value=Name(
                            id='node_set',
                            ctx=Load(),
                            lineno=29,
                            col_offset=16,
                            end_lineno=29,
                            end_col_offset=24),
                          attr='append',
                          ctx=Load(),
                          lineno=29,
                          col_offset=16,
                          end_lineno=29,
                          end_col_offset=31),
                        args=[
                          Attribute(
                            value=Name(
                              id='link',
                              ctx=Load(),
                              lineno=29,
                              col_offset=32,
                              end_lineno=29,
                              end_col_offset=36),
                            attr='from_',
                            ctx=Load(),
                            lineno=29,
                            col_offset=32,
                            end_lineno=29,
                            end_col_offset=42)],
                        keywords=[],
                        lineno=29,
                        col_offset=16,
                        end_lineno=29,
                        end_col_offset=43),
                      lineno=29,
                      col_offset=16,
                      end_lineno=29,
                      end_col_offset=43)],
                  orelse=[],
                  lineno=28,
                  col_offset=12,
                  end_lineno=29,
                  end_col_offset=43),
                If(
                  test=Compare(
                    left=Attribute(
                      value=Name(
                        id='link',
                        ctx=Load(),
                        lineno=30,
                        col_offset=15,
                        end_lineno=30,
                        end_col_offset=19),
                      attr='to',
                      ctx=Load(),
                      lineno=30,
                      col_offset=15,
                      end_lineno=30,
                      end_col_offset=22),
                    ops=[
                      NotIn()],
                    comparators=[
                      Name(
                        id='node_set',
                        ctx=Load(),
                        lineno=30,
                        col_offset=30,
                        end_lineno=30,
                        end_col_offset=38)],
                    lineno=30,
                    col_offset=15,
                    end_lineno=30,
                    end_col_offset=38),
                  body=[
                    Expr(
                      value=Call(
                        func=Attribute(
                          value=Name(
                            id='node_set',
                            ctx=Load(),
                            lineno=31,
                            col_offset=16,
                            end_lineno=31,
                            end_col_offset=24),
                          attr='append',
                          ctx=Load(),
                          lineno=31,
                          col_offset=16,
                          end_lineno=31,
                          end_col_offset=31),
                        args=[
                          Attribute(
                            value=Name(
                              id='link',
                              ctx=Load(),
                              lineno=31,
                              col_offset=32,
                              end_lineno=31,
                              end_col_offset=36),
                            attr='to',
                            ctx=Load(),
                            lineno=31,
                            col_offset=32,
                            end_lineno=31,
                            end_col_offset=39)],
                        keywords=[],
                        lineno=31,
                        col_offset=16,
                        end_lineno=31,
                        end_col_offset=40),
                      lineno=31,
                      col_offset=16,
                      end_lineno=31,
                      end_col_offset=40)],
                  orelse=[],
                  lineno=30,
                  col_offset=12,
                  end_lineno=31,
                  end_col_offset=40)],
              orelse=[],
              lineno=26,
              col_offset=8,
              end_lineno=31,
              end_col_offset=40),
            If(
              test=Call(
                func=Name(
                  id='isinstance',
                  ctx=Load(),
                  lineno=32,
                  col_offset=11,
                  end_lineno=32,
                  end_col_offset=21),
                args=[
                  Name(
                    id='element',
                    ctx=Load(),
                    lineno=32,
                    col_offset=22,
                    end_lineno=32,
                    end_col_offset=29),
                  Name(
                    id='MermaidBlock',
                    ctx=Load(),
                    lineno=32,
                    col_offset=31,
                    end_lineno=32,
                    end_col_offset=43)],
                keywords=[],
                lineno=32,
                col_offset=11,
                end_lineno=32,
                end_col_offset=44),
              body=[
                AnnAssign(
                  target=Name(
                    id='block',
                    ctx=Store(),
                    lineno=33,
                    col_offset=12,
                    end_lineno=33,
                    end_col_offset=17),
                  annotation=Name(
                    id='MermaidBlock',
                    ctx=Load(),
                    lineno=33,
                    col_offset=20,
                    end_lineno=33,
                    end_col_offset=32),
                  value=Name(
                    id='element',
                    ctx=Load(),
                    lineno=33,
                    col_offset=35,
                    end_lineno=33,
                    end_col_offset=42),
                  simple=1,
                  lineno=33,
                  col_offset=12,
                  end_lineno=33,
                  end_col_offset=42),
                Expr(
                  value=Call(
                    func=Attribute(
                      value=Name(
                        id='node_set',
                        ctx=Load(),
                        lineno=34,
                        col_offset=12,
                        end_lineno=34,
                        end_col_offset=20),
                      attr='extend',
                      ctx=Load(),
                      lineno=34,
                      col_offset=12,
                      end_lineno=34,
                      end_col_offset=27),
                    args=[
                      Call(
                        func=Name(
                          id='_get_unique_nodes',
                          ctx=Load(),
                          lineno=34,
                          col_offset=28,
                          end_lineno=34,
                          end_col_offset=45),
                        args=[
                          Attribute(
                            value=Name(
                              id='block',
                              ctx=Load(),
                              lineno=34,
                              col_offset=46,
                              end_lineno=34,
                              end_col_offset=51),
                            attr='block_contents',
                            ctx=Load(),
                            lineno=34,
                            col_offset=46,
                            end_lineno=34,
                            end_col_offset=66)],
                        keywords=[],
                        lineno=34,
                        col_offset=28,
                        end_lineno=34,
                        end_col_offset=67)],
                    keywords=[],
                    lineno=34,
                    col_offset=12,
                    end_lineno=34,
                    end_col_offset=68),
                  lineno=34,
                  col_offset=12,
                  end_lineno=34,
                  end_col_offset=68)],
              orelse=[],
              lineno=32,
              col_offset=8,
              end_lineno=34,
              end_col_offset=68)],
          orelse=[],
          lineno=25,
          col_offset=4,
          end_lineno=34,
          end_col_offset=68),
        Return(
          value=Name(
            id='node_set',
            ctx=Load(),
            lineno=35,
            col_offset=11,
            end_lineno=35,
            end_col_offset=19),
          lineno=35,
          col_offset=4,
          end_lineno=35,
          end_col_offset=19)],
      decorator_list=[],
      returns=Subscript(
        value=Name(
          id='list',
          ctx=Load(),
          lineno=22,
          col_offset=57,
          end_lineno=22,
          end_col_offset=61),
        slice=Name(
          id='MermaidNode',
          ctx=Load(),
          lineno=22,
          col_offset=62,
          end_lineno=22,
          end_col_offset=73),
        ctx=Load(),
        lineno=22,
        col_offset=57,
        end_lineno=22,
        end_col_offset=74),
      lineno=22,
      col_offset=0,
      end_lineno=35,
      end_col_offset=19),
    FunctionDef(
      name='_get_aliases_for_safe_names',
      args=arguments(
        posonlyargs=[],
        args=[
          arg(
            arg='elements',
            annotation=Subscript(
              value=Name(
                id='list',
                ctx=Load(),
                lineno=38,
                col_offset=42,
                end_lineno=38,
                end_col_offset=46),
              slice=Name(
                id='MermaidElement',
                ctx=Load(),
                lineno=38,
                col_offset=47,
                end_lineno=38,
                end_col_offset=61),
              ctx=Load(),
              lineno=38,
              col_offset=42,
              end_lineno=38,
              end_col_offset=62),
            lineno=38,
            col_offset=32,
            end_lineno=38,
            end_col_offset=62),
          arg(
            arg='indent',
            annotation=Name(
              id='int',
              ctx=Load(),
              lineno=38,
              col_offset=72,
              end_lineno=38,
              end_col_offset=75),
            lineno=38,
            col_offset=64,
            end_lineno=38,
            end_col_offset=75)],
        kwonlyargs=[],
        kw_defaults=[],
        defaults=[
          Constant(
            value=1,
            lineno=38,
            col_offset=78,
            end_lineno=38,
            end_col_offset=79)]),
      body=[
        Assign(
          targets=[
            Name(
              id='alias_string',
              ctx=Store(),
              lineno=39,
              col_offset=4,
              end_lineno=39,
              end_col_offset=16)],
          value=Constant(
            value='',
            lineno=39,
            col_offset=19,
            end_lineno=39,
            end_col_offset=21),
          lineno=39,
          col_offset=4,
          end_lineno=39,
          end_col_offset=21),
        For(
          target=Name(
            id='node',
            ctx=Store(),
            lineno=40,
            col_offset=8,
            end_lineno=40,
            end_col_offset=12),
          iter=Call(
            func=Name(
              id='_get_unique_nodes',
              ctx=Load(),
              lineno=40,
              col_offset=16,
              end_lineno=40,
              end_col_offset=33),
            args=[],
            keywords=[
              keyword(
                arg='elements',
                value=Name(
                  id='elements',
                  ctx=Load(),
                  lineno=40,
                  col_offset=43,
                  end_lineno=40,
                  end_col_offset=51),
                lineno=40,
                col_offset=34,
                end_lineno=40,
                end_col_offset=51)],
            lineno=40,
            col_offset=16,
            end_lineno=40,
            end_col_offset=52),
          body=[
            AugAssign(
              target=Name(
                id='alias_string',
                ctx=Store(),
                lineno=41,
                col_offset=8,
                end_lineno=41,
                end_col_offset=20),
              op=Add(),
              value=JoinedStr(
                values=[
                  FormattedValue(
                    value=BinOp(
                      left=Name(
                        id='TAB',
                        ctx=Load(),
                        lineno=41,
                        col_offset=27,
                        end_lineno=41,
                        end_col_offset=30),
                      op=Mult(),
                      right=Name(
                        id='indent',
                        ctx=Load(),
                        lineno=41,
                        col_offset=33,
                        end_lineno=41,
                        end_col_offset=39),
                      lineno=41,
                      col_offset=27,
                      end_lineno=41,
                      end_col_offset=39),
                    conversion=-1,
                    lineno=41,
                    col_offset=24,
                    end_lineno=41,
                    end_col_offset=92),
                  FormattedValue(
                    value=Attribute(
                      value=Name(
                        id='node',
                        ctx=Load(),
                        lineno=41,
                        col_offset=41,
                        end_lineno=41,
                        end_col_offset=45),
                      attr='mermaid_safe_name',
                      ctx=Load(),
                      lineno=41,
                      col_offset=41,
                      end_lineno=41,
                      end_col_offset=63),
                    conversion=-1,
                    lineno=41,
                    col_offset=24,
                    end_lineno=41,
                    end_col_offset=92),
                  Constant(
                    value='["',
                    lineno=41,
                    col_offset=24,
                    end_lineno=41,
                    end_col_offset=92),
                  FormattedValue(
                    value=Attribute(
                      value=Name(
                        id='node',
                        ctx=Load(),
                        lineno=41,
                        col_offset=68,
                        end_lineno=41,
                        end_col_offset=72),
                      attr='display_name',
                      ctx=Load(),
                      lineno=41,
                      col_offset=68,
                      end_lineno=41,
                      end_col_offset=85),
                    conversion=-1,
                    lineno=41,
                    col_offset=24,
                    end_lineno=41,
                    end_col_offset=92),
                  Constant(
                    value='"]\n',
                    lineno=41,
                    col_offset=24,
                    end_lineno=41,
                    end_col_offset=92)],
                lineno=41,
                col_offset=24,
                end_lineno=41,
                end_col_offset=92),
              lineno=41,
              col_offset=8,
              end_lineno=41,
              end_col_offset=92)],
          orelse=[],
          lineno=40,
          col_offset=4,
          end_lineno=41,
          end_col_offset=92),
        Return(
          value=Call(
            func=Name(
              id='_sanitize',
              ctx=Load(),
              lineno=42,
              col_offset=11,
              end_lineno=42,
              end_col_offset=20),
            args=[
              Name(
                id='alias_string',
                ctx=Load(),
                lineno=42,
                col_offset=21,
                end_lineno=42,
                end_col_offset=33)],
            keywords=[],
            lineno=42,
            col_offset=11,
            end_lineno=42,
            end_col_offset=34),
          lineno=42,
          col_offset=4,
          end_lineno=42,
          end_col_offset=34)],
      decorator_list=[],
      returns=Name(
        id='str',
        ctx=Load(),
        lineno=38,
        col_offset=84,
        end_lineno=38,
        end_col_offset=87),
      lineno=38,
      col_offset=0,
      end_lineno=42,
      end_col_offset=34),
    FunctionDef(
      name='_get_flow_link_text',
      args=arguments(
        posonlyargs=[],
        args=[
          arg(
            arg='link',
            annotation=Name(
              id='MermaidElement',
              ctx=Load(),
              lineno=45,
              col_offset=30,
              end_lineno=45,
              end_col_offset=44),
            lineno=45,
            col_offset=24,
            end_lineno=45,
            end_col_offset=44),
          arg(
            arg='indent',
            annotation=Name(
              id='int',
              ctx=Load(),
              lineno=45,
              col_offset=54,
              end_lineno=45,
              end_col_offset=57),
            lineno=45,
            col_offset=46,
            end_lineno=45,
            end_col_offset=57)],
        kwonlyargs=[],
        kw_defaults=[],
        defaults=[]),
      body=[
        Assign(
          targets=[
            Name(
              id='from_name',
              ctx=Store(),
              lineno=46,
              col_offset=4,
              end_lineno=46,
              end_col_offset=13)],
          value=Attribute(
            value=Attribute(
              value=Name(
                id='link',
                ctx=Load(),
                lineno=46,
                col_offset=16,
                end_lineno=46,
                end_col_offset=20),
              attr='from_',
              ctx=Load(),
              lineno=46,
              col_offset=16,
              end_lineno=46,
              end_col_offset=26),
            attr='mermaid_safe_name',
            ctx=Load(),
            lineno=46,
            col_offset=16,
            end_lineno=46,
            end_col_offset=44),
          lineno=46,
          col_offset=4,
          end_lineno=46,
          end_col_offset=44),
        Assign(
          targets=[
            Name(
              id='to_name',
              ctx=Store(),
              lineno=47,
              col_offset=4,
              end_lineno=47,
              end_col_offset=11)],
          value=Attribute(
            value=Attribute(
              value=Name(
                id='link',
                ctx=Load(),
                lineno=47,
                col_offset=14,
                end_lineno=47,
                end_col_offset=18),
              attr='to',
              ctx=Load(),
              lineno=47,
              col_offset=14,
              end_lineno=47,
              end_col_offset=21),
            attr='mermaid_safe_name',
            ctx=Load(),
            lineno=47,
            col_offset=14,
            end_lineno=47,
            end_col_offset=39),
          lineno=47,
          col_offset=4,
          end_lineno=47,
          end_col_offset=39),
        Return(
          value=JoinedStr(
            values=[
              FormattedValue(
                value=BinOp(
                  left=Name(
                    id='TAB',
                    ctx=Load(),
                    lineno=49,
                    col_offset=14,
                    end_lineno=49,
                    end_col_offset=17),
                  op=Mult(),
                  right=Name(
                    id='indent',
                    ctx=Load(),
                    lineno=49,
                    col_offset=18,
                    end_lineno=49,
                    end_col_offset=24),
                  lineno=49,
                  col_offset=14,
                  end_lineno=49,
                  end_col_offset=24),
                conversion=-1,
                lineno=49,
                col_offset=11,
                end_lineno=49,
                end_col_offset=53),
              FormattedValue(
                value=Name(
                  id='from_name',
                  ctx=Load(),
                  lineno=49,
                  col_offset=26,
                  end_lineno=49,
                  end_col_offset=35),
                conversion=-1,
                lineno=49,
                col_offset=11,
                end_lineno=49,
                end_col_offset=53),
              Constant(
                value=' --> ',
                lineno=49,
                col_offset=11,
                end_lineno=49,
                end_col_offset=53),
              FormattedValue(
                value=Name(
                  id='to_name',
                  ctx=Load(),
                  lineno=49,
                  col_offset=42,
                  end_lineno=49,
                  end_col_offset=49),
                conversion=-1,
                lineno=49,
                col_offset=11,
                end_lineno=49,
                end_col_offset=53),
              Constant(
                value='\n',
                lineno=49,
                col_offset=11,
                end_lineno=49,
                end_col_offset=53)],
            lineno=49,
            col_offset=11,
            end_lineno=49,
            end_col_offset=53),
          lineno=49,
          col_offset=4,
          end_lineno=49,
          end_col_offset=53)],
      decorator_list=[],
      returns=Name(
        id='str',
        ctx=Load(),
        lineno=45,
        col_offset=62,
        end_lineno=45,
        end_col_offset=65),
      lineno=45,
      col_offset=0,
      end_lineno=49,
      end_col_offset=53),
    FunctionDef(
      name='_get_flow_connections',
      args=arguments(
        posonlyargs=[],
        args=[
          arg(
            arg='elements',
            annotation=Subscript(
              value=Name(
                id='list',
                ctx=Load(),
                lineno=52,
                col_offset=36,
                end_lineno=52,
                end_col_offset=40),
              slice=Name(
                id='MermaidElement',
                ctx=Load(),
                lineno=52,
                col_offset=41,
                end_lineno=52,
                end_col_offset=55),
              ctx=Load(),
              lineno=52,
              col_offset=36,
              end_lineno=52,
              end_col_offset=56),
            lineno=52,
            col_offset=26,
            end_lineno=52,
            end_col_offset=56),
          arg(
            arg='indent',
            annotation=Name(
              id='int',
              ctx=Load(),
              lineno=52,
              col_offset=66,
              end_lineno=52,
              end_col_offset=69),
            lineno=52,
            col_offset=58,
            end_lineno=52,
            end_col_offset=69)],
        kwonlyargs=[],
        kw_defaults=[],
        defaults=[
          Constant(
            value=1,
            lineno=52,
            col_offset=72,
            end_lineno=52,
            end_col_offset=73)]),
      body=[
        Assign(
          targets=[
            Name(
              id='connection_text',
              ctx=Store(),
              lineno=53,
              col_offset=4,
              end_lineno=53,
              end_col_offset=19)],
          value=Constant(
            value='',
            lineno=53,
            col_offset=22,
            end_lineno=53,
            end_col_offset=24),
          lineno=53,
          col_offset=4,
          end_lineno=53,
          end_col_offset=24),
        For(
          target=Name(
            id='element',
            ctx=Store(),
            lineno=54,
            col_offset=8,
            end_lineno=54,
            end_col_offset=15),
          iter=Name(
            id='elements',
            ctx=Load(),
            lineno=54,
            col_offset=19,
            end_lineno=54,
            end_col_offset=27),
          body=[
            If(
              test=Call(
                func=Name(
                  id='isinstance',
                  ctx=Load(),
                  lineno=55,
                  col_offset=11,
                  end_lineno=55,
                  end_col_offset=21),
                args=[
                  Name(
                    id='element',
                    ctx=Load(),
                    lineno=55,
                    col_offset=22,
                    end_lineno=55,
                    end_col_offset=29),
                  Name(
                    id='MermaidLink',
                    ctx=Load(),
                    lineno=55,
                    col_offset=31,
                    end_lineno=55,
                    end_col_offset=42)],
                keywords=[],
                lineno=55,
                col_offset=11,
                end_lineno=55,
                end_col_offset=43),
              body=[
                AnnAssign(
                  target=Name(
                    id='link',
                    ctx=Store(),
                    lineno=56,
                    col_offset=12,
                    end_lineno=56,
                    end_col_offset=16),
                  annotation=Name(
                    id='MermaidLink',
                    ctx=Load(),
                    lineno=56,
                    col_offset=18,
                    end_lineno=56,
                    end_col_offset=29),
                  value=Name(
                    id='element',
                    ctx=Load(),
                    lineno=56,
                    col_offset=32,
                    end_lineno=56,
                    end_col_offset=39),
                  simple=1,
                  lineno=56,
                  col_offset=12,
                  end_lineno=56,
                  end_col_offset=39),
                AugAssign(
                  target=Name(
                    id='connection_text',
                    ctx=Store(),
                    lineno=57,
                    col_offset=12,
                    end_lineno=57,
                    end_col_offset=27),
                  op=Add(),
                  value=Call(
                    func=Name(
                      id='_get_flow_link_text',
                      ctx=Load(),
                      lineno=57,
                      col_offset=31,
                      end_lineno=57,
                      end_col_offset=50),
                    args=[],
                    keywords=[
                      keyword(
                        arg='link',
                        value=Name(
                          id='link',
                          ctx=Load(),
                          lineno=57,
                          col_offset=56,
                          end_lineno=57,
                          end_col_offset=60),
                        lineno=57,
                        col_offset=51,
                        end_lineno=57,
                        end_col_offset=60),
                      keyword(
                        arg='indent',
                        value=Name(
                          id='indent',
                          ctx=Load(),
                          lineno=57,
                          col_offset=69,
                          end_lineno=57,
                          end_col_offset=75),
                        lineno=57,
                        col_offset=62,
                        end_lineno=57,
                        end_col_offset=75)],
                    lineno=57,
                    col_offset=31,
                    end_lineno=57,
                    end_col_offset=76),
                  lineno=57,
                  col_offset=12,
                  end_lineno=57,
                  end_col_offset=76)],
              orelse=[
                If(
                  test=Call(
                    func=Name(
                      id='isinstance',
                      ctx=Load(),
                      lineno=58,
                      col_offset=13,
                      end_lineno=58,
                      end_col_offset=23),
                    args=[
                      Name(
                        id='element',
                        ctx=Load(),
                        lineno=58,
                        col_offset=24,
                        end_lineno=58,
                        end_col_offset=31),
                      Name(
                        id='MermaidBlock',
                        ctx=Load(),
                        lineno=58,
                        col_offset=33,
                        end_lineno=58,
                        end_col_offset=45)],
                    keywords=[],
                    lineno=58,
                    col_offset=13,
                    end_lineno=58,
                    end_col_offset=46),
                  body=[
                    AnnAssign(
                      target=Name(
                        id='block',
                        ctx=Store(),
                        lineno=59,
                        col_offset=12,
                        end_lineno=59,
                        end_col_offset=17),
                      annotation=Name(
                        id='MermaidBlock',
                        ctx=Load(),
                        lineno=59,
                        col_offset=19,
                        end_lineno=59,
                        end_col_offset=31),
                      value=Name(
                        id='element',
                        ctx=Load(),
                        lineno=59,
                        col_offset=34,
                        end_lineno=59,
                        end_col_offset=41),
                      simple=1,
                      lineno=59,
                      col_offset=12,
                      end_lineno=59,
                      end_col_offset=41),
                    AugAssign(
                      target=Name(
                        id='connection_text',
                        ctx=Store(),
                        lineno=60,
                        col_offset=12,
                        end_lineno=60,
                        end_col_offset=27),
                      op=Add(),
                      value=Call(
                        func=Name(
                          id='_get_block_text',
                          ctx=Load(),
                          lineno=60,
                          col_offset=31,
                          end_lineno=60,
                          end_col_offset=46),
                        args=[],
                        keywords=[
                          keyword(
                            arg='block',
                            value=Name(
                              id='block',
                              ctx=Load(),
                              lineno=60,
                              col_offset=53,
                              end_lineno=60,
                              end_col_offset=58),
                            lineno=60,
                            col_offset=47,
                            end_lineno=60,
                            end_col_offset=58),
                          keyword(
                            arg='indent',
                            value=Name(
                              id='indent',
                              ctx=Load(),
                              lineno=60,
                              col_offset=67,
                              end_lineno=60,
                              end_col_offset=73),
                            lineno=60,
                            col_offset=60,
                            end_lineno=60,
                            end_col_offset=73)],
                        lineno=60,
                        col_offset=31,
                        end_lineno=60,
                        end_col_offset=74),
                      lineno=60,
                      col_offset=12,
                      end_lineno=60,
                      end_col_offset=74)],
                  orelse=[],
                  lineno=58,
                  col_offset=8,
                  end_lineno=60,
                  end_col_offset=74)],
              lineno=55,
              col_offset=8,
              end_lineno=60,
              end_col_offset=74)],
          orelse=[],
          lineno=54,
          col_offset=4,
          end_lineno=60,
          end_col_offset=74),
        Return(
          value=Name(
            id='connection_text',
            ctx=Load(),
            lineno=62,
            col_offset=11,
            end_lineno=62,
            end_col_offset=26),
          lineno=62,
          col_offset=4,
          end_lineno=62,
          end_col_offset=26)],
      decorator_list=[],
      returns=Name(
        id='str',
        ctx=Load(),
        lineno=52,
        col_offset=78,
        end_lineno=52,
        end_col_offset=81),
      lineno=52,
      col_offset=0,
      end_lineno=62,
      end_col_offset=26),
    FunctionDef(
      name='_get_block_text',
      args=arguments(
        posonlyargs=[],
        args=[
          arg(
            arg='block',
            annotation=Name(
              id='MermaidBlock',
              ctx=Load(),
              lineno=65,
              col_offset=27,
              end_lineno=65,
              end_col_offset=39),
            lineno=65,
            col_offset=20,
            end_lineno=65,
            end_col_offset=39),
          arg(
            arg='indent',
            annotation=Name(
              id='int',
              ctx=Load(),
              lineno=65,
              col_offset=49,
              end_lineno=65,
              end_col_offset=52),
            lineno=65,
            col_offset=41,
            end_lineno=65,
            end_col_offset=52)],
        kwonlyargs=[],
        kw_defaults=[],
        defaults=[]),
      body=[
        Assign(
          targets=[
            Name(
              id='block_text',
              ctx=Store(),
              lineno=66,
              col_offset=4,
              end_lineno=66,
              end_col_offset=14)],
          value=Constant(
            value='',
            lineno=66,
            col_offset=17,
            end_lineno=66,
            end_col_offset=19),
          lineno=66,
          col_offset=4,
          end_lineno=66,
          end_col_offset=19),
        If(
          test=Call(
            func=Name(
              id='isinstance',
              ctx=Load(),
              lineno=67,
              col_offset=7,
              end_lineno=67,
              end_col_offset=17),
            args=[
              Name(
                id='block',
                ctx=Load(),
                lineno=67,
                col_offset=18,
                end_lineno=67,
                end_col_offset=23),
              Name(
                id='MermaidFunction',
                ctx=Load(),
                lineno=67,
                col_offset=25,
                end_lineno=67,
                end_col_offset=40)],
            keywords=[],
            lineno=67,
            col_offset=7,
            end_lineno=67,
            end_col_offset=41),
          body=[
            AnnAssign(
              target=Name(
                id='function_def',
                ctx=Store(),
                lineno=68,
                col_offset=8,
                end_lineno=68,
                end_col_offset=20),
              annotation=Name(
                id='MermaidFunction',
                ctx=Load(),
                lineno=68,
                col_offset=23,
                end_lineno=68,
                end_col_offset=38),
              value=Name(
                id='block',
                ctx=Load(),
                lineno=68,
                col_offset=41,
                end_lineno=68,
                end_col_offset=46),
              simple=1,
              lineno=68,
              col_offset=8,
              end_lineno=68,
              end_col_offset=46),
            AugAssign(
              target=Name(
                id='block_text',
                ctx=Store(),
                lineno=69,
                col_offset=8,
                end_lineno=69,
                end_col_offset=18),
              op=Add(),
              value=JoinedStr(
                values=[
                  FormattedValue(
                    value=BinOp(
                      left=Name(
                        id='TAB',
                        ctx=Load(),
                        lineno=69,
                        col_offset=25,
                        end_lineno=69,
                        end_col_offset=28),
                      op=Mult(),
                      right=Name(
                        id='indent',
                        ctx=Load(),
                        lineno=69,
                        col_offset=31,
                        end_lineno=69,
                        end_col_offset=37),
                      lineno=69,
                      col_offset=25,
                      end_lineno=69,
                      end_col_offset=37),
                    conversion=-1,
                    lineno=69,
                    col_offset=22,
                    end_lineno=69,
                    end_col_offset=77),
                  Constant(
                    value='subgraph ',
                    lineno=69,
                    col_offset=22,
                    end_lineno=69,
                    end_col_offset=77),
                  FormattedValue(
                    value=Attribute(
                      value=Name(
                        id='function_def',
                        ctx=Load(),
                        lineno=69,
                        col_offset=48,
                        end_lineno=69,
                        end_col_offset=60),
                      attr='display_name',
                      ctx=Load(),
                      lineno=69,
                      col_offset=48,
                      end_lineno=69,
                      end_col_offset=73),
                    conversion=-1,
                    lineno=69,
                    col_offset=22,
                    end_lineno=69,
                    end_col_offset=77),
                  Constant(
                    value='\n',
                    lineno=69,
                    col_offset=22,
                    end_lineno=69,
                    end_col_offset=77)],
                lineno=69,
                col_offset=22,
                end_lineno=69,
                end_col_offset=77),
              lineno=69,
              col_offset=8,
              end_lineno=69,
              end_col_offset=77),
            AugAssign(
              target=Name(
                id='block_text',
                ctx=Store(),
                lineno=70,
                col_offset=8,
                end_lineno=70,
                end_col_offset=18),
              op=Add(),
              value=JoinedStr(
                values=[
                  FormattedValue(
                    value=BinOp(
                      left=Name(
                        id='TAB',
                        ctx=Load(),
                        lineno=70,
                        col_offset=25,
                        end_lineno=70,
                        end_col_offset=28),
                      op=Mult(),
                      right=BinOp(
                        left=Name(
                          id='indent',
                          ctx=Load(),
                          lineno=70,
                          col_offset=32,
                          end_lineno=70,
                          end_col_offset=38),
                        op=Add(),
                        right=Constant(
                          value=1,
                          lineno=70,
                          col_offset=41,
                          end_lineno=70,
                          end_col_offset=42),
                        lineno=70,
                        col_offset=32,
                        end_lineno=70,
                        end_col_offset=42),
                      lineno=70,
                      col_offset=25,
                      end_lineno=70,
                      end_col_offset=43),
                    conversion=-1,
                    lineno=70,
                    col_offset=22,
                    end_lineno=70,
                    end_col_offset=59),
                  Constant(
                    value='direction TB\n',
                    lineno=70,
                    col_offset=22,
                    end_lineno=70,
                    end_col_offset=59)],
                lineno=70,
                col_offset=22,
                end_lineno=70,
                end_col_offset=59),
              lineno=70,
              col_offset=8,
              end_lineno=70,
              end_col_offset=59),
            AugAssign(
              target=Name(
                id='block_text',
                ctx=Store(),
                lineno=71,
                col_offset=8,
                end_lineno=71,
                end_col_offset=18),
              op=Add(),
              value=Call(
                func=Name(
                  id='_get_flow_connections',
                  ctx=Load(),
                  lineno=71,
                  col_offset=22,
                  end_lineno=71,
                  end_col_offset=43),
                args=[
                  Attribute(
                    value=Name(
                      id='function_def',
                      ctx=Load(),
                      lineno=71,
                      col_offset=44,
                      end_lineno=71,
                      end_col_offset=56),
                    attr='block_contents',
                    ctx=Load(),
                    lineno=71,
                    col_offset=44,
                    end_lineno=71,
                    end_col_offset=71),
                  BinOp(
                    left=Name(
                      id='indent',
                      ctx=Load(),
                      lineno=71,
                      col_offset=73,
                      end_lineno=71,
                      end_col_offset=79),
                    op=Add(),
                    right=Constant(
                      value=1,
                      lineno=71,
                      col_offset=82,
                      end_lineno=71,
                      end_col_offset=83),
                    lineno=71,
                    col_offset=73,
                    end_lineno=71,
                    end_col_offset=83)],
                keywords=[],
                lineno=71,
                col_offset=22,
                end_lineno=71,
                end_col_offset=84),
              lineno=71,
              col_offset=8,
              end_lineno=71,
              end_col_offset=84),
            AugAssign(
              target=Name(
                id='block_text',
                ctx=Store(),
                lineno=72,
                col_offset=8,
                end_lineno=72,
                end_col_offset=18),
              op=Add(),
              value=JoinedStr(
                values=[
                  FormattedValue(
                    value=BinOp(
                      left=Name(
                        id='TAB',
                        ctx=Load(),
                        lineno=72,
                        col_offset=25,
                        end_lineno=72,
                        end_col_offset=28),
                      op=Mult(),
                      right=Name(
                        id='indent',
                        ctx=Load(),
                        lineno=72,
                        col_offset=31,
                        end_lineno=72,
                        end_col_offset=37),
                      lineno=72,
                      col_offset=25,
                      end_lineno=72,
                      end_col_offset=37),
                    conversion=-1,
                    lineno=72,
                    col_offset=22,
                    end_lineno=72,
                    end_col_offset=44),
                  Constant(
                    value='end\n',
                    lineno=72,
                    col_offset=22,
                    end_lineno=72,
                    end_col_offset=44)],
                lineno=72,
                col_offset=22,
                end_lineno=72,
                end_col_offset=44),
              lineno=72,
              col_offset=8,
              end_lineno=72,
              end_col_offset=44)],
          orelse=[
            If(
              test=Call(
                func=Name(
                  id='isinstance',
                  ctx=Load(),
                  lineno=73,
                  col_offset=9,
                  end_lineno=73,
                  end_col_offset=19),
                args=[
                  Name(
                    id='block',
                    ctx=Load(),
                    lineno=73,
                    col_offset=20,
                    end_lineno=73,
                    end_col_offset=25),
                  Name(
                    id='MermaidClass',
                    ctx=Load(),
                    lineno=73,
                    col_offset=27,
                    end_lineno=73,
                    end_col_offset=39)],
                keywords=[],
                lineno=73,
                col_offset=9,
                end_lineno=73,
                end_col_offset=40),
              body=[
                AnnAssign(
                  target=Name(
                    id='class_def',
                    ctx=Store(),
                    lineno=74,
                    col_offset=8,
                    end_lineno=74,
                    end_col_offset=17),
                  annotation=Name(
                    id='MermaidClass',
                    ctx=Load(),
                    lineno=74,
                    col_offset=20,
                    end_lineno=74,
                    end_col_offset=32),
                  value=Name(
                    id='block',
                    ctx=Load(),
                    lineno=74,
                    col_offset=35,
                    end_lineno=74,
                    end_col_offset=40),
                  simple=1,
                  lineno=74,
                  col_offset=8,
                  end_lineno=74,
                  end_col_offset=40),
                AugAssign(
                  target=Name(
                    id='block_text',
                    ctx=Store(),
                    lineno=75,
                    col_offset=8,
                    end_lineno=75,
                    end_col_offset=18),
                  op=Add(),
                  value=JoinedStr(
                    values=[
                      FormattedValue(
                        value=BinOp(
                          left=Name(
                            id='TAB',
                            ctx=Load(),
                            lineno=75,
                            col_offset=25,
                            end_lineno=75,
                            end_col_offset=28),
                          op=Mult(),
                          right=Name(
                            id='indent',
                            ctx=Load(),
                            lineno=75,
                            col_offset=31,
                            end_lineno=75,
                            end_col_offset=37),
                          lineno=75,
                          col_offset=25,
                          end_lineno=75,
                          end_col_offset=37),
                        conversion=-1,
                        lineno=75,
                        col_offset=22,
                        end_lineno=75,
                        end_col_offset=74),
                      Constant(
                        value='subgraph ',
                        lineno=75,
                        col_offset=22,
                        end_lineno=75,
                        end_col_offset=74),
                      FormattedValue(
                        value=Attribute(
                          value=Name(
                            id='class_def',
                            ctx=Load(),
                            lineno=75,
                            col_offset=48,
                            end_lineno=75,
                            end_col_offset=57),
                          attr='display_name',
                          ctx=Load(),
                          lineno=75,
                          col_offset=48,
                          end_lineno=75,
                          end_col_offset=70),
                        conversion=-1,
                        lineno=75,
                        col_offset=22,
                        end_lineno=75,
                        end_col_offset=74),
                      Constant(
                        value='\n',
                        lineno=75,
                        col_offset=22,
                        end_lineno=75,
                        end_col_offset=74)],
                    lineno=75,
                    col_offset=22,
                    end_lineno=75,
                    end_col_offset=74),
                  lineno=75,
                  col_offset=8,
                  end_lineno=75,
                  end_col_offset=74),
                AugAssign(
                  target=Name(
                    id='block_text',
                    ctx=Store(),
                    lineno=76,
                    col_offset=8,
                    end_lineno=76,
                    end_col_offset=18),
                  op=Add(),
                  value=JoinedStr(
                    values=[
                      FormattedValue(
                        value=BinOp(
                          left=Name(
                            id='TAB',
                            ctx=Load(),
                            lineno=76,
                            col_offset=25,
                            end_lineno=76,
                            end_col_offset=28),
                          op=Mult(),
                          right=BinOp(
                            left=Name(
                              id='indent',
                              ctx=Load(),
                              lineno=76,
                              col_offset=32,
                              end_lineno=76,
                              end_col_offset=38),
                            op=Add(),
                            right=Constant(
                              value=1,
                              lineno=76,
                              col_offset=41,
                              end_lineno=76,
                              end_col_offset=42),
                            lineno=76,
                            col_offset=32,
                            end_lineno=76,
                            end_col_offset=42),
                          lineno=76,
                          col_offset=25,
                          end_lineno=76,
                          end_col_offset=43),
                        conversion=-1,
                        lineno=76,
                        col_offset=22,
                        end_lineno=76,
                        end_col_offset=59),
                      Constant(
                        value='direction TB\n',
                        lineno=76,
                        col_offset=22,
                        end_lineno=76,
                        end_col_offset=59)],
                    lineno=76,
                    col_offset=22,
                    end_lineno=76,
                    end_col_offset=59),
                  lineno=76,
                  col_offset=8,
                  end_lineno=76,
                  end_col_offset=59),
                AugAssign(
                  target=Name(
                    id='block_text',
                    ctx=Store(),
                    lineno=77,
                    col_offset=8,
                    end_lineno=77,
                    end_col_offset=18),
                  op=Add(),
                  value=Call(
                    func=Name(
                      id='_get_flow_connections',
                      ctx=Load(),
                      lineno=77,
                      col_offset=22,
                      end_lineno=77,
                      end_col_offset=43),
                    args=[
                      Attribute(
                        value=Name(
                          id='class_def',
                          ctx=Load(),
                          lineno=77,
                          col_offset=44,
                          end_lineno=77,
                          end_col_offset=53),
                        attr='block_contents',
                        ctx=Load(),
                        lineno=77,
                        col_offset=44,
                        end_lineno=77,
                        end_col_offset=68),
                      BinOp(
                        left=Name(
                          id='indent',
                          ctx=Load(),
                          lineno=77,
                          col_offset=70,
                          end_lineno=77,
                          end_col_offset=76),
                        op=Add(),
                        right=Constant(
                          value=1,
                          lineno=77,
                          col_offset=79,
                          end_lineno=77,
                          end_col_offset=80),
                        lineno=77,
                        col_offset=70,
                        end_lineno=77,
                        end_col_offset=80)],
                    keywords=[],
                    lineno=77,
                    col_offset=22,
                    end_lineno=77,
                    end_col_offset=81),
                  lineno=77,
                  col_offset=8,
                  end_lineno=77,
                  end_col_offset=81),
                AugAssign(
                  target=Name(
                    id='block_text',
                    ctx=Store(),
                    lineno=78,
                    col_offset=8,
                    end_lineno=78,
                    end_col_offset=18),
                  op=Add(),
                  value=JoinedStr(
                    values=[
                      FormattedValue(
                        value=BinOp(
                          left=Name(
                            id='TAB',
                            ctx=Load(),
                            lineno=78,
                            col_offset=25,
                            end_lineno=78,
                            end_col_offset=28),
                          op=Mult(),
                          right=Name(
                            id='indent',
                            ctx=Load(),
                            lineno=78,
                            col_offset=31,
                            end_lineno=78,
                            end_col_offset=37),
                          lineno=78,
                          col_offset=25,
                          end_lineno=78,
                          end_col_offset=37),
                        conversion=-1,
                        lineno=78,
                        col_offset=22,
                        end_lineno=78,
                        end_col_offset=44),
                      Constant(
                        value='end\n',
                        lineno=78,
                        col_offset=22,
                        end_lineno=78,
                        end_col_offset=44)],
                    lineno=78,
                    col_offset=22,
                    end_lineno=78,
                    end_col_offset=44),
                  lineno=78,
                  col_offset=8,
                  end_lineno=78,
                  end_col_offset=44)],
              orelse=[
                If(
                  test=Call(
                    func=Name(
                      id='isinstance',
                      ctx=Load(),
                      lineno=79,
                      col_offset=9,
                      end_lineno=79,
                      end_col_offset=19),
                    args=[
                      Name(
                        id='block',
                        ctx=Load(),
                        lineno=79,
                        col_offset=20,
                        end_lineno=79,
                        end_col_offset=25),
                      Name(
                        id='MermaidFor',
                        ctx=Load(),
                        lineno=79,
                        col_offset=27,
                        end_lineno=79,
                        end_col_offset=37)],
                    keywords=[],
                    lineno=79,
                    col_offset=9,
                    end_lineno=79,
                    end_col_offset=38),
                  body=[
                    AnnAssign(
                      target=Name(
                        id='for_def',
                        ctx=Store(),
                        lineno=80,
                        col_offset=8,
                        end_lineno=80,
                        end_col_offset=15),
                      annotation=Name(
                        id='MermaidFor',
                        ctx=Load(),
                        lineno=80,
                        col_offset=18,
                        end_lineno=80,
                        end_col_offset=28),
                      value=Name(
                        id='block',
                        ctx=Load(),
                        lineno=80,
                        col_offset=31,
                        end_lineno=80,
                        end_col_offset=36),
                      simple=1,
                      lineno=80,
                      col_offset=8,
                      end_lineno=80,
                      end_col_offset=36),
                    AugAssign(
                      target=Name(
                        id='block_text',
                        ctx=Store(),
                        lineno=81,
                        col_offset=8,
                        end_lineno=81,
                        end_col_offset=18),
                      op=Add(),
                      value=JoinedStr(
                        values=[
                          FormattedValue(
                            value=BinOp(
                              left=Name(
                                id='TAB',
                                ctx=Load(),
                                lineno=81,
                                col_offset=25,
                                end_lineno=81,
                                end_col_offset=28),
                              op=Mult(),
                              right=Name(
                                id='indent',
                                ctx=Load(),
                                lineno=81,
                                col_offset=31,
                                end_lineno=81,
                                end_col_offset=37),
                              lineno=81,
                              col_offset=25,
                              end_lineno=81,
                              end_col_offset=37),
                            conversion=-1,
                            lineno=81,
                            col_offset=22,
                            end_lineno=81,
                            end_col_offset=71),
                          Constant(
                            value='%% loop ',
                            lineno=81,
                            col_offset=22,
                            end_lineno=81,
                            end_col_offset=71),
                          FormattedValue(
                            value=Attribute(
                              value=Name(
                                id='for_def',
                                ctx=Load(),
                                lineno=81,
                                col_offset=47,
                                end_lineno=81,
                                end_col_offset=54),
                              attr='display_name',
                              ctx=Load(),
                              lineno=81,
                              col_offset=47,
                              end_lineno=81,
                              end_col_offset=67),
                            conversion=-1,
                            lineno=81,
                            col_offset=22,
                            end_lineno=81,
                            end_col_offset=71),
                          Constant(
                            value='\n',
                            lineno=81,
                            col_offset=22,
                            end_lineno=81,
                            end_col_offset=71)],
                        lineno=81,
                        col_offset=22,
                        end_lineno=81,
                        end_col_offset=71),
                      lineno=81,
                      col_offset=8,
                      end_lineno=81,
                      end_col_offset=71),
                    AugAssign(
                      target=Name(
                        id='block_text',
                        ctx=Store(),
                        lineno=82,
                        col_offset=8,
                        end_lineno=82,
                        end_col_offset=18),
                      op=Add(),
                      value=Call(
                        func=Name(
                          id='_get_flow_connections',
                          ctx=Load(),
                          lineno=82,
                          col_offset=22,
                          end_lineno=82,
                          end_col_offset=43),
                        args=[
                          Attribute(
                            value=Name(
                              id='for_def',
                              ctx=Load(),
                              lineno=82,
                              col_offset=44,
                              end_lineno=82,
                              end_col_offset=51),
                            attr='block_contents',
                            ctx=Load(),
                            lineno=82,
                            col_offset=44,
                            end_lineno=82,
                            end_col_offset=66),
                          BinOp(
                            left=Name(
                              id='indent',
                              ctx=Load(),
                              lineno=82,
                              col_offset=68,
                              end_lineno=82,
                              end_col_offset=74),
                            op=Add(),
                            right=Constant(
                              value=1,
                              lineno=82,
                              col_offset=77,
                              end_lineno=82,
                              end_col_offset=78),
                            lineno=82,
                            col_offset=68,
                            end_lineno=82,
                            end_col_offset=78)],
                        keywords=[],
                        lineno=82,
                        col_offset=22,
                        end_lineno=82,
                        end_col_offset=79),
                      lineno=82,
                      col_offset=8,
                      end_lineno=82,
                      end_col_offset=79),
                    AugAssign(
                      target=Name(
                        id='block_text',
                        ctx=Store(),
                        lineno=83,
                        col_offset=8,
                        end_lineno=83,
                        end_col_offset=18),
                      op=Add(),
                      value=JoinedStr(
                        values=[
                          FormattedValue(
                            value=BinOp(
                              left=Name(
                                id='TAB',
                                ctx=Load(),
                                lineno=83,
                                col_offset=25,
                                end_lineno=83,
                                end_col_offset=28),
                              op=Mult(),
                              right=Name(
                                id='indent',
                                ctx=Load(),
                                lineno=83,
                                col_offset=31,
                                end_lineno=83,
                                end_col_offset=37),
                              lineno=83,
                              col_offset=25,
                              end_lineno=83,
                              end_col_offset=37),
                            conversion=-1,
                            lineno=83,
                            col_offset=22,
                            end_lineno=83,
                            end_col_offset=70),
                          Constant(
                            value='%% end ',
                            lineno=83,
                            col_offset=22,
                            end_lineno=83,
                            end_col_offset=70),
                          FormattedValue(
                            value=Attribute(
                              value=Name(
                                id='for_def',
                                ctx=Load(),
                                lineno=83,
                                col_offset=46,
                                end_lineno=83,
                                end_col_offset=53),
                              attr='display_name',
                              ctx=Load(),
                              lineno=83,
                              col_offset=46,
                              end_lineno=83,
                              end_col_offset=66),
                            conversion=-1,
                            lineno=83,
                            col_offset=22,
                            end_lineno=83,
                            end_col_offset=70),
                          Constant(
                            value='\n',
                            lineno=83,
                            col_offset=22,
                            end_lineno=83,
                            end_col_offset=70)],
                        lineno=83,
                        col_offset=22,
                        end_lineno=83,
                        end_col_offset=70),
                      lineno=83,
                      col_offset=8,
                      end_lineno=83,
                      end_col_offset=70)],
                  orelse=[
                    AugAssign(
                      target=Name(
                        id='block_text',
                        ctx=Store(),
                        lineno=85,
                        col_offset=8,
                        end_lineno=85,
                        end_col_offset=18),
                      op=Add(),
                      value=Call(
                        func=Name(
                          id='_get_flow_connections',
                          ctx=Load(),
                          lineno=85,
                          col_offset=22,
                          end_lineno=85,
                          end_col_offset=43),
                        args=[
                          Attribute(
                            value=Name(
                              id='block',
                              ctx=Load(),
                              lineno=85,
                              col_offset=44,
                              end_lineno=85,
                              end_col_offset=49),
                            attr='block_contents',
                            ctx=Load(),
                            lineno=85,
                            col_offset=44,
                            end_lineno=85,
                            end_col_offset=64),
                          Name(
                            id='indent',
                            ctx=Load(),
                            lineno=85,
                            col_offset=66,
                            end_lineno=85,
                            end_col_offset=72)],
                        keywords=[],
                        lineno=85,
                        col_offset=22,
                        end_lineno=85,
                        end_col_offset=73),
                      lineno=85,
                      col_offset=8,
                      end_lineno=85,
                      end_col_offset=73)],
                  lineno=79,
                  col_offset=4,
                  end_lineno=85,
                  end_col_offset=73)],
              lineno=73,
              col_offset=4,
              end_lineno=85,
              end_col_offset=73)],
          lineno=67,
          col_offset=4,
          end_lineno=85,
          end_col_offset=73),
        Return(
          value=Name(
            id='block_text',
            ctx=Load(),
            lineno=86,
            col_offset=11,
            end_lineno=86,
            end_col_offset=21),
          lineno=86,
          col_offset=4,
          end_lineno=86,
          end_col_offset=21)],
      decorator_list=[],
      returns=Name(
        id='str',
        ctx=Load(),
        lineno=65,
        col_offset=57,
        end_lineno=65,
        end_col_offset=60),
      lineno=65,
      col_offset=0,
      end_lineno=86,
      end_col_offset=21),
    FunctionDef(
      name='create_mermaid_flow_graph_from_links',
      args=arguments(
        posonlyargs=[],
        args=[
          arg(
            arg='elements',
            annotation=Subscript(
              value=Name(
                id='list',
                ctx=Load(),
                lineno=89,
                col_offset=51,
                end_lineno=89,
                end_col_offset=55),
              slice=Name(
                id='MermaidElement',
                ctx=Load(),
                lineno=89,
                col_offset=56,
                end_lineno=89,
                end_col_offset=70),
              ctx=Load(),
              lineno=89,
              col_offset=51,
              end_lineno=89,
              end_col_offset=71),
            lineno=89,
            col_offset=41,
            end_lineno=89,
            end_col_offset=71)],
        kwonlyargs=[],
        kw_defaults=[],
        defaults=[]),
      body=[
        Assign(
          targets=[
            Name(
              id='alaises',
              ctx=Store(),
              lineno=90,
              col_offset=4,
              end_lineno=90,
              end_col_offset=11)],
          value=Call(
            func=Name(
              id='_get_aliases_for_safe_names',
              ctx=Load(),
              lineno=90,
              col_offset=14,
              end_lineno=90,
              end_col_offset=41),
            args=[],
            keywords=[
              keyword(
                arg='elements',
                value=Name(
                  id='elements',
                  ctx=Load(),
                  lineno=90,
                  col_offset=51,
                  end_lineno=90,
                  end_col_offset=59),
                lineno=90,
                col_offset=42,
                end_lineno=90,
                end_col_offset=59)],
            lineno=90,
            col_offset=14,
            end_lineno=90,
            end_col_offset=60),
          lineno=90,
          col_offset=4,
          end_lineno=90,
          end_col_offset=60),
        Assign(
          targets=[
            Name(
              id='flow_connections',
              ctx=Store(),
              lineno=91,
              col_offset=4,
              end_lineno=91,
              end_col_offset=20)],
          value=Call(
            func=Name(
              id='_get_flow_connections',
              ctx=Load(),
              lineno=91,
              col_offset=23,
              end_lineno=91,
              end_col_offset=44),
            args=[],
            keywords=[
              keyword(
                arg='elements',
                value=Name(
                  id='elements',
                  ctx=Load(),
                  lineno=91,
                  col_offset=54,
                  end_lineno=91,
                  end_col_offset=62),
                lineno=91,
                col_offset=45,
                end_lineno=91,
                end_col_offset=62)],
            lineno=91,
            col_offset=23,
            end_lineno=91,
            end_col_offset=63),
          lineno=91,
          col_offset=4,
          end_lineno=91,
          end_col_offset=63),
        Return(
          value=JoinedStr(
            values=[
              Constant(
                value='```mermaid\nflowchart TB\n',
                lineno=93,
                col_offset=8,
                end_lineno=97,
                end_col_offset=15),
              FormattedValue(
                value=Name(
                  id='alaises',
                  ctx=Load(),
                  lineno=95,
                  col_offset=11,
                  end_lineno=95,
                  end_col_offset=18),
                conversion=-1,
                lineno=93,
                col_offset=8,
                end_lineno=97,
                end_col_offset=15),
              Constant(
                value='\n',
                lineno=93,
                col_offset=8,
                end_lineno=97,
                end_col_offset=15),
              FormattedValue(
                value=Name(
                  id='flow_connections',
                  ctx=Load(),
                  lineno=96,
                  col_offset=11,
                  end_lineno=96,
                  end_col_offset=27),
                conversion=-1,
                lineno=93,
                col_offset=8,
                end_lineno=97,
                end_col_offset=15),
              Constant(
                value='\n```\n',
                lineno=93,
                col_offset=8,
                end_lineno=97,
                end_col_offset=15)],
            lineno=93,
            col_offset=8,
            end_lineno=97,
            end_col_offset=15),
          lineno=92,
          col_offset=4,
          end_lineno=98,
          end_col_offset=5)],
      decorator_list=[],
      returns=Name(
        id='str',
        ctx=Load(),
        lineno=89,
        col_offset=76,
        end_lineno=89,
        end_col_offset=79),
      lineno=89,
      col_offset=0,
      end_lineno=98,
      end_col_offset=5)],
  type_ignores=[])
```
</details>

